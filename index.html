<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PDF Invoice Generator</title>
    <!-- <script src="src/index.js"></script> -->
    <script src="src/html2pdf.bundle.js"></script>
    <link rel="stylesheet" href="src/style.css">
</head>

<body>
    <div class="a4" id="myPdfFile">
        <div class="container">
            <div>
                <img src="logo.png" style="width: 100%;
            height: auto;" alt="Foto 1">
                <div class="topText">
                    <label for="textarea">SAYIN,</label>
                    <textarea readonly style="width: 100%; border: 0; resize: none; font-size: 16px; height: 40px;">Murat Vehbi Karahan</textarea>
                    <label for="textarea">Adres:</label>
                    <div style="
                            height: 80px;
                            resize: none;
                            word-wrap: break-word;
                            overflow-wrap: break-word;
                        " >204 Newburgh Avenue <br/> Medford NY 11763-3117
                            </div>
                            
                </div>
            </div>
            <div class="faturaBolumu">
                <img src="maliye.png" alt="Foto 2">
                <table class="faturaTablo">
                    <tr>
                        <th>FATURA</th>
                    </tr>
                    <tr>
                        <th>Seri:</th>
                    <td>
                        <div class="seriLetterWrapper" style="width: 100%;">
                            <span class="seriLetter">A</span>
                            <input type="text" style="border: 2px solid black;" id="fixedInput" >
                        </div>
                    </td>
                    </tr>
                    <th>Sıra No:</th>
                    <td><input type="text" style="border: 2px solid black;"></td>
                    </tr>
                    <tr>
                        <th>Tarih:</th>
                        <td><input type="date" style="border: 2px solid black;"></td>
                    </tr>
                    <tr>
                        <th>İrsaliye Tarih:</th>
                        <td><input type="date" style="border: 2px solid black;"></td>
                    </tr>
                    <tr>
                        <th>İrsaliye No:</th>
                        <td><input type="text" style="border: 2px solid black;"></td>
                    </tr>
                </table>
            </div>
        </div>
        <div class="container">
            <label style="font-size: 10pt;">MÜŞTERİ V.D.: 5120214358</label>
            <label style="font-size: 10pt;">HES.NO: 837392</label>
        </div>
        <table class="miktarTablo">
            <tr>
                <th>Miktar</th>
                <th>Malın Cinsi</th>
                <th>Birim Fiyatı</th>
                <th>Tutarı</th>
            </tr>
            <tr>
                <td class="tableRowElement"><input id="miktar1" type="number" oninput="calculate(1)"></td>
                <td><input type="text"></td>
                <td><input id="birim1" type="number" oninput="calculate(1)"></td>
                <td><input id="tutar1" type="number" readonly></td>
            </tr>
            <tr>
                <td class="tableRowElement"><input id="miktar2" type="number" oninput="calculate(2)"></td>
                <td><input type="text"></td>
                <td><input id="birim2" type="number" oninput="calculate(2)"></td>
                <td><input id="tutar2" type="number" readonly></td>
            </tr>
            <tr>
                <td class="tableRowElement"><input id="miktar3" type="number" oninput="calculate(3)"></td>
                <td><input type="text"></td>
                <td><input id="birim3" type="number" oninput="calculate(3)"></td>
                <td><input id="tutar3" type="number" readonly></td>
            </tr>
            <tr>
                <td class="tableRowElement"><input id="miktar4" type="number" oninput="calculate(4)"></td>
                <td><input type="text"></td>
                <td><input id="birim4" type="number" oninput="calculate(4)"></td>
                <td><input id="tutar4" type="number" readonly></td>
            </tr>
            <tr>
                <td class="tableRowElement"><input id="miktar5" type="number" oninput="calculate(5)"></td>
                <td><input type="text"></td>
                <td><input id="birim5" type="number" oninput="calculate(5)"></td>
                <td><input id="tutar5" type="number" readonly></td>
            </tr>
            <tr>
                <td class="tableRowElement"><input id="miktar6" type="number" oninput="calculate(6)"></td>
                <td><input type="text"></td>
                <td><input id="birim6" type="number" oninput="calculate(6)"></td>
                <td><input id="tutar6" type="number" readonly></td>
            </tr>
            <tr>
                <td class="tableRowElement"><input id="miktar7" type="number" oninput="calculate(7)"></td>
                <td><input type="text"></td>
                <td><input id="birim7" type="number" oninput="calculate(7)"></td>
                <td><input id="tutar7" type="number" readonly></td>
            </tr>
            <tr>
                <td class="tableRowElement"><input id="miktar8" type="number" oninput="calculate(8)"></td>
                <td><input type="text"></td>
                <td><input id="birim8" type="number" oninput="calculate(8)"></td>
                <td><input id="tutar8" type="number" readonly></td>
            </tr>
            <tr>
                <td class="tableRowElement"><input id="miktar9" type="number" oninput="calculate(9)"></td>
                <td><input type="text"></td>
                <td><input id="birim9" type="number" oninput="calculate(9)"></td>
                <td><input id="tutar9" type="number" readonly></td>
            </tr>
            <tr>
                <td class="tableRowElement"><input id="miktar10" type="number" oninput="calculate(10)"></td>
                <td><input type="text"></td>
                <td><input id="birim10" type="number" oninput="calculate(10)"></td>
                <td><input id="tutar10" type="number" readonly></td>
            </tr>
            <tr>
                <td class="tableRowElement"><input id="miktar11" type="number" oninput="calculate(11)"></td>
                <td><input type="text"></td>
                <td><input id="birim11" type="number" oninput="calculate(11)"></td>
                <td><input id="tutar11" type="number" readonly></td>
            </tr>
            <tr>
                <td class="tableRowElement"><input id="miktar12" type="number" oninput="calculate(12)"></td>
                <td><input type="text"></td>
                <td><input id="birim12" type="number" oninput="calculate(12)"></td>
                <td><input id="tutar12" type="number" readonly></td>
            </tr>
            <tr>
                <td class="tableRowElement"><input id="miktar13" type="number" oninput="calculate(13)"></td>
                <td><input type="text"></td>
                <td><input id="birim13" type="number" oninput="calculate(13)"></td>
                <td><input id="tutar13" type="number" readonly></td>
            </tr>
            <tr>
                <td class="tableRowElement"><input id="miktar14" type="number" oninput="calculate(14)"></td>
                <td><input type="text"></td>
                <td><input id="birim14" type="number" oninput="calculate(14)"></td>
                <td><input id="tutar14" type="number" readonly></td>
            </tr>
            <tr>
                <td class="tableRowElement"><input id="miktar15" type="number" oninput="calculate(15)"></td>
                <td><input type="text"></td>
                <td><input id="birim15" type="number" oninput="calculate(15)"></td>
                <td><input id="tutar15" type="number" readonly></td>
            </tr>
            
        </table>
        <div class="container">
            <div>
                YALNIZ
                <textarea id="textArea2"
                    style="width: 100%; height: 80px; border:1px solıd black; border-radius: 15px; resize: none;"></textarea>
                <div style="width: 100%; font-size: 10pt; display: none; border: 2px solid black; word-wrap: break-word;"
                    id="displayTextArea2"></div>
                TL'dir
            </div>
            <div class="container">
                <table class="toplamTablo">
                    <tr>
                        <th>Toplam</th>
                        <td><input id="toplam" type="text" readonly></td>
                    </tr>
                    <tr>
                        <th>KDV%18</th>
                        <td><input id="kdv" type="text" readonly></td>
                    </tr>
                    <tr>
                        <th>G.Toplam</th>
                        <td><input id="grandToplam" type="text" readonly></td>
                    </tr>
                </table>
            </div>
        </div>
    </div>
    <div style="display: flex;justify-content: center;align-items: center;">
        <button id="yazdir" class="yazdirBtn">Yazdır</button>
    </div>

</body>
<script>
    function calculate(id) {
        var miktar = document.getElementById('miktar' + id).value;
        var birim = document.getElementById('birim' + id).value;

        if (miktar && birim) {
            document.getElementById('tutar' + id).value = parseFloat(miktar) * parseFloat(birim);
        }
    }
    function calculate(id) {
        var miktar = document.getElementById('miktar' + id).value;
        var birim = document.getElementById('birim' + id).value;

        if (miktar && birim) {
            document.getElementById('tutar' + id).value = parseFloat(miktar) * parseFloat(birim);
            calculateTotal();
            calculateKDV();
            calculateGrandTotal();
        }
    }

    function calculateTotal() {
        var total = 0;
        for (var i = 1; i <= 15; i++) {
            var element = document.getElementById('tutar' + i);
            var tutar = parseFloat(element.value);
            if (!isNaN(tutar)) {
                total += tutar;
            }
        }
        document.getElementById('toplam').value = total;
    }

    function calculateKDV() {
        var total = parseFloat(document.getElementById('toplam').value);
        var kdvPercentage = 0.18; // %18 KDV
        var kdv = parseInt(total * kdvPercentage);
        document.getElementById('kdv').value = kdv;
    }

    function calculateGrandTotal() {
        var total = parseFloat(document.getElementById('toplam').value);
        var kdv = parseFloat(document.getElementById('kdv').value);
        var grandTotal = total + kdv;
        document.getElementById('grandToplam').value = grandTotal;
    }

    function handleInput() {
        const fixedBeginning = 'A';
        const inputElement = document.getElementById('fixedInput');
        const inputValue = inputElement.value;

        if (!inputValue.startsWith(fixedBeginning)) {
            inputElement.value = fixedBeginning + inputValue;
        }
    }

    function insertBreaks(text) {
    let result = '';
    for(let i = 0; i < text.length; i++) {
        if (i > 0 && i % 15 === 0) {
            result += '<br/>';
        }
        result += text[i];
    }
    return result;
}


    document.getElementById("yazdir").addEventListener("click", function download() {
        const element = document.getElementById("myPdfFile");
        const textarea2 = document.getElementById("textArea2");
        const display2 = document.getElementById("displayTextArea2");

        display2.innerHTML = insertBreaks(textarea2.value);
        display2.style.display = 'block';
        textarea2.style.display = 'none';
        var opt = {
            margin: 0,
            filename: 'myfile.pdf',
            image: { type: 'jpeg', quality: 0.98 },
            html2canvas: { scale: 5, scrollY: 0 },
            jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' },
            wrapContent: true
        };
        html2pdf().from(element).set(opt).save();

        setTimeout(() => {
            display2.style.display = 'none';
            textarea2.style.display = 'block';
        }, 1500);
    });


</script>

</html>